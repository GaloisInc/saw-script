// Test: Record types, values, operations.
let t1 = {{ {x = 1, y = 2} : {x : [8], y : [8]} }};
write_rocq_term "TestRec" [] [] "" t1;

let t2 = {{ {val = 42} : {val : [8]} }};
write_rocq_term "TestRec_Single" [] [] "" t2;

let t3 = {{ {a = 1, b = 2, c = 3} : {a : [8], b : [8], c : [8]} }};
write_rocq_term "TestRec_Three" [] [] "" t3;

let t4 = {{ {x = 1, y = 2} : {x : [8], y : [16]} }};
write_rocq_term "TestRec_MixedWidth" [] [] "" t4;

let t5 = {{ {inner = {x = 1, y = 2}, z = 3} : {inner : {x : [8], y : [8]}, z : [8]} }};
write_rocq_term "TestRec_Nested" [] [] "" t5;

let t6 = {{ {x = 42, y = 100}.y : [8] }};
write_rocq_term "TestRec_ProjY" [] [] "" t6;

let t7 = {{ {inner = {x = 1, y = 2}, z = 3}.inner.x : [8] }};
write_rocq_term "TestRec_NestedProj" [] [] "" t7;

let t8 = {{ { t1 | x = 3 } : {x : [8], y : [8]} }};
write_rocq_term "TestRec_Update1" [] [] "" t8;

let t9 = {{ (True, True) }};
write_rocq_term "TestRec_Tuple" [] [] "" t9;

let t10 = {{ { pt = t1, size = 100 } }};
write_rocq_term "TestRec_Nested" [] [] "" t10;

let t11 = {{ { t1 | x = 30 }          == { x = 30, y = 20 } }};
write_rocq_term "TestRec_Update2" [] [] "" t11;

let t12 = {{ { t9 | 0 = False }       == (False,True) }};
write_rocq_term "TestRec_TupleUpdate" [] [] "" t12;

let t13 = {{ { t1 | x -> x + 5 }      == { x = 20, y = 20 } }};
write_rocq_term "TestRec_RelativeUpdate" [] [] "" t13;

let t14 = {{ { t10 | pt.x = 10 }       == { pt = { x = 10, y = 20 }, size = 100 } }};
write_rocq_term "TestRec_NestedField1" [] [] "" t14;

let t15 = {{ { t10 | pt.x -> x + 10 }  == { pt = { x = 25, y = 20 }, size = 100 } }};
write_rocq_term "TestRec_NestedField2" [] [] "" t15;
