#!/bin/sh
# cvecheck-rs.sh: do CVE checks
# usage: cvecheck-rs.sh [--write-json]

set -e

export THIS_DIR=$(realpath $(dirname $0))
. ${THIS_DIR}/variables.sh

PROJ_DIR=${TOP_DIR}/doc/rust-tutorial/code/salsa20

echo
echo "Running cargo-audit in ${PROJ_DIR}:"

cd ${PROJ_DIR}

if [ $# == 0 ] ; then
    cargo audit
elif [ $# -eq 1 ] && [ $1 = "--write-json" ] ; then
    cargo audit --json > ${RS_JSON_FILE}
else
  echo "Usage: cvecheck-rs.sh [--write-json]"
  exit 1
fi
